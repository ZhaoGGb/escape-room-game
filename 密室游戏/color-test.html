<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¢œè‰²åˆ¤å®šå•å…ƒæµ‹è¯•</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            background: #1a1a2e;
            color: #eee;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #00ff88;
            border-bottom: 2px solid #00ff88;
            padding-bottom: 10px;
        }
        .test-section {
            background: #16213e;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #00ff88;
        }
        .test-section h2 {
            color: #ff6b6b;
            margin-top: 0;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .pass {
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid #00ff88;
        }
        .fail {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid #ff6b6b;
        }
        .summary {
            font-size: 1.2em;
            padding: 20px;
            text-align: center;
            border-radius: 8px;
            margin-top: 30px;
        }
        .summary.all-pass {
            background: rgba(0, 255, 136, 0.3);
            border: 2px solid #00ff88;
        }
        .summary.has-fail {
            background: rgba(255, 107, 107, 0.3);
            border: 2px solid #ff6b6b;
        }
        pre {
            background: #0f0f23;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        button {
            background: #00ff88;
            color: #1a1a2e;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 4px;
            margin: 10px 5px;
        }
        button:hover {
            background: #00cc6a;
        }
        .color-sample {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 1px solid #fff;
            vertical-align: middle;
            margin: 0 5px;
        }
    </style>
</head>
<body>
    <h1>ğŸ¨ åŠ¨æ€é¢œè‰²åˆ¤å®šç³»ç»Ÿ - å•å…ƒæµ‹è¯•</h1>
    
    <button onclick="runAllTests()">â–¶ è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
    <button onclick="runThresholdTest()">â–¶ é˜ˆå€¼åŒºé—´æµ‹è¯•</button>
    <button onclick="runBoundaryTest()">â–¶ è¾¹ç•Œå€¼æµ‹è¯•</button>
    <button onclick="runVarianceTest()">â–¶ éšæœºå·®å¼‚æµ‹è¯•</button>
    
    <div id="testResults"></div>

    <script>
        /**
         * åŠ¨æ€é¢œè‰²é˜ˆå€¼ç³»ç»Ÿæµ‹è¯•
         * æµ‹è¯•è§„åˆ™ï¼š
         * - Råˆ†é‡ï¼šéšæœºç”Ÿæˆ[240, 255]åŒºé—´çš„æ•´æ•°ä½œä¸ºæœ€å°å€¼
         * - Gåˆ†é‡ï¼šéšæœºç”Ÿæˆ[0, 15]åŒºé—´çš„æ•´æ•°ä½œä¸ºæœ€å¤§å€¼
         * - Båˆ†é‡ï¼šéšæœºç”Ÿæˆ[0, 15]åŒºé—´çš„æ•´æ•°ä½œä¸ºæœ€å¤§å€¼
         * çœŸçº¢åˆ¤å®šï¼šR >= redMin ä¸” G <= greenMax ä¸” B <= blueMax
         */
        
        let testPassCount = 0;
        let testFailCount = 0;
        
        function resetCounts() {
            testPassCount = 0;
            testFailCount = 0;
        }
        
        function assert(condition, message, details = '') {
            if (condition) {
                testPassCount++;
                return `<div class="test-result pass">âœ… ${message}</div>`;
            } else {
                testFailCount++;
                return `<div class="test-result fail">âŒ ${message}<br><pre>${details}</pre></div>`;
            }
        }
        
        function generateThresholds() {
            return {
                redMin: Math.floor(Math.random() * 16) + 240,  // [240, 255]
                greenMax: Math.floor(Math.random() * 16),       // [0, 15]
                blueMax: Math.floor(Math.random() * 16)         // [0, 15]
            };
        }
        
        function isTrueRed(r, g, b, thresholds) {
            return r >= thresholds.redMin && g <= thresholds.greenMax && b <= thresholds.blueMax;
        }
        
        function runThresholdTest() {
            resetCounts();
            const results = document.getElementById('testResults');
            let html = '<div class="test-section"><h2>1. é˜ˆå€¼åŒºé—´æµ‹è¯•ï¼ˆè¿ç»­100å±€ï¼‰</h2>';
            
            const thresholdsSet = new Set();
            let allInRange = true;
            
            for (let i = 0; i < 100; i++) {
                const t = generateThresholds();
                const tKey = `${t.redMin}-${t.greenMax}-${t.blueMax}`;
                thresholdsSet.add(tKey);
                
                if (t.redMin < 240 || t.redMin > 255) {
                    allInRange = false;
                    html += assert(false, `ç¬¬${i+1}å±€: redMin=${t.redMin} è¶…å‡ºåŒºé—´[240,255]`);
                }
                if (t.greenMax < 0 || t.greenMax > 15) {
                    allInRange = false;
                    html += assert(false, `ç¬¬${i+1}å±€: greenMax=${t.greenMax} è¶…å‡ºåŒºé—´[0,15]`);
                }
                if (t.blueMax < 0 || t.blueMax > 15) {
                    allInRange = false;
                    html += assert(false, `ç¬¬${i+1}å±€: blueMax=${t.blueMax} è¶…å‡ºåŒºé—´[0,15]`);
                }
            }
            
            html += assert(allInRange, 'æ‰€æœ‰é˜ˆå€¼å‡åœ¨æŒ‡å®šåŒºé—´å†…');
            html += assert(thresholdsSet.size >= 50, `100å±€ä¸­ç”Ÿæˆäº† ${thresholdsSet.size} ç§ä¸åŒçš„é˜ˆå€¼ç»„åˆï¼ˆåº”â‰¥50ï¼‰`);
            
            html += '</div>';
            results.innerHTML += html;
            return allInRange;
        }
        
        function runBoundaryTest() {
            resetCounts();
            const results = document.getElementById('testResults');
            let html = '<div class="test-section"><h2>2. è¾¹ç•Œå€¼æµ‹è¯•</h2>';
            
            for (let i = 0; i < 100; i++) {
                const thresholds = generateThresholds();
                const { redMin, greenMax, blueMax } = thresholds;
                
                // è¾¹ç•Œå€¼æµ‹è¯•ï¼šRGB(255,0,0) åº”è¯¥æ˜¯çœŸçº¢
                const test1 = isTrueRed(255, 0, 0, thresholds);
                html += assert(test1, `ç¬¬${i+1}å±€: RGB(255,0,0) åº”ä¸ºçœŸçº¢`);
                
                // è¾¹ç•Œå€¼æµ‹è¯•ï¼šRGB(240,15,15) åº”è¯¥æ˜¯çœŸçº¢
                const test2 = isTrueRed(240, 15, 15, thresholds);
                html += assert(test2, `ç¬¬${i+1}å±€: RGB(240,15,15) åº”ä¸ºçœŸçº¢`);
                
                // è¾¹ç•Œå€¼æµ‹è¯•ï¼šRGB(250,5,10) åº”è¯¥æ˜¯çœŸçº¢
                const test3 = isTrueRed(250, 5, 10, thresholds);
                html += assert(test3, `ç¬¬${i+1}å±€: RGB(250,5,10) åº”ä¸ºçœŸçº¢`);
                
                // è¾¹ç•Œå€¼æµ‹è¯•ï¼šRGB(239,0,0) åº”è¯¥ä¸æ˜¯çœŸçº¢ï¼ˆå¦‚æœredMin>=240ï¼‰
                const test4 = !isTrueRed(239, 0, 0, thresholds);
                html += assert(test4, `ç¬¬${i+1}å±€: RGB(239,0,0) åº”ä¸ºéçœŸçº¢ (R<${redMin})`);
                
                // è¾¹ç•Œå€¼æµ‹è¯•ï¼šRGB(255,16,0) åº”è¯¥ä¸æ˜¯çœŸçº¢ï¼ˆå¦‚æœgreenMax<16ï¼‰
                const test5 = !isTrueRed(255, 16, 0, thresholds);
                html += assert(test5, `ç¬¬${i+1}å±€: RGB(255,16,0) åº”ä¸ºéçœŸçº¢ (G>${greenMax})`);
                
                // è¾¹ç•Œå€¼æµ‹è¯•ï¼šRGB(255,0,16) åº”è¯¥ä¸æ˜¯çœŸçº¢ï¼ˆå¦‚æœblueMax<16ï¼‰
                const test6 = !isTrueRed(255, 0, 16, thresholds);
                html += assert(test6, `ç¬¬${i+1}å±€: RGB(255,0,16) åº”ä¸ºéçœŸçº¢ (B>${blueMax})`);
            }
            
            html += '</div>';
            results.innerHTML += html;
            return testFailCount === 0;
        }
        
        function runVarianceTest() {
            resetCounts();
            const results = document.getElementById('testResults');
            let html = '<div class="test-section"><h2>3. éšæœºå·®å¼‚æµ‹è¯•ï¼ˆæ¯å±€ä½“éªŒä¸åŒï¼‰</h2>';
            
            const uniqueRedMins = new Set();
            const uniqueGreenMaxs = new Set();
            const uniqueBlueMaxs = new Set();
            
            for (let i = 0; i < 100; i++) {
                const t = generateThresholds();
                uniqueRedMins.add(t.redMin);
                uniqueGreenMaxs.add(t.greenMax);
                uniqueBlueMaxs.add(t.blueMax);
            }
            
            html += assert(uniqueRedMins.size > 1, `redMin ç”Ÿæˆäº† ${uniqueRedMins.size} ç§ä¸åŒå€¼`);
            html += assert(uniqueGreenMaxs.size > 1, `greenMax ç”Ÿæˆäº† ${uniqueGreenMaxs.size} ç§ä¸åŒå€¼`);
            html += assert(uniqueBlueMaxs.size > 1, `blueMax ç”Ÿæˆäº† ${uniqueBlueMaxs.size} ç§ä¸åŒå€¼`);
            
            html += `<h3>é˜ˆå€¼åˆ†å¸ƒç»Ÿè®¡ï¼š</h3>`;
            html += `<pre>redMin åˆ†å¸ƒ: ${JSON.stringify([...uniqueRedMins].sort((a,b)=>a-b))}</pre>`;
            html += `<pre>greenMax åˆ†å¸ƒ: ${JSON.stringify([...uniqueGreenMaxs].sort((a,b)=>a-b))}</pre>`;
            html += `<pre>blueMax åˆ†å¸ƒ: ${JSON.stringify([...uniqueBlueMaxs].sort((a,b)=>a-b))}</pre>`;
            
            html += '</div>';
            results.innerHTML += html;
            return testFailCount === 0;
        }
        
        function runAllTests() {
            document.getElementById('testResults').innerHTML = '';
            resetCounts();
            
            const pass1 = runThresholdTest();
            const pass2 = runBoundaryTest();
            const pass3 = runVarianceTest();
            
            const allPass = pass1 && pass2 && pass3;
            
            const summaryClass = allPass ? 'all-pass' : 'has-fail';
            const summaryText = allPass ? 'ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼' : `âŒ ${testFailCount} ä¸ªæµ‹è¯•å¤±è´¥`;
            
            document.getElementById('testResults').innerHTML += `
                <div class="summary ${summaryClass}">
                    <h2>æµ‹è¯•æ€»ç»“</h2>
                    <p>é€šè¿‡: ${testPassCount} ä¸ªæµ‹è¯•</p>
                    <p>å¤±è´¥: ${testFailCount} ä¸ªæµ‹è¯•</p>
                    <p>${summaryText}</p>
                    <p style="font-size:0.9em;color:#aaa;">æ¯å±€æ¸¸æˆçš„çœŸçº¢åˆ¤å®šæ ‡å‡†éƒ½ä¼šéšæœºå˜åŒ–ï¼Œç¡®ä¿æ¸¸æˆä½“éªŒçš„å·®å¼‚æ€§ï¼</p>
                </div>
            `;
        }
        
        // é¡µé¢åŠ è½½åè‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.onload = function() {
            runAllTests();
        };
    </script>
</body>
</html>
